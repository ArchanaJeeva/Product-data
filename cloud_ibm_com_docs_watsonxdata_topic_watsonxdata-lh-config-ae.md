IBM Cloud Docs Skip to contentIBM CloudCatalogCatalogCost EstimatorCost EstimatorHelpHelpDocsLog inSign upError Skip to content IBM Cloud IBM Cloud CatalogCatalog CatalogCatalog Cost EstimatorCost Estimator Cost EstimatorCost Estimator HelpHelpDocs HelpHelp Docs Docs Docs Log in Log in Sign up Sign up Error Configuring Analytics Engine Configuring Analytics Engine You can configure IBM Analytics Engine instance to connect to the IBMÂ® watsonx.data instance by setting watsonx.data configurations and Spark related configuration as the default configuration for the IBM Analytics Engine instance. You can configure Analytics Engine instance with default settings in one of the following ways: Configure by using the IBM CloudÂ® console. Configure by using the Analytics Engine API. Configure by using the Analytics Engine CLI. Prerequisites Ensure you have the following instances ready: IBMÂ® watsonx.data instance. IBM Analytics Engine instance. Fetch the following information from IBMÂ® watsonx.data: HMS URL from watsonx.data.For more information on getting the HMS credentials, see Getting (Hive metastore) HMS Credentials. HMS Credentials from watsonx.data. For more information on getting the HMS credentials, see Getting (Hive metastore) HMS Credentials. Configuring Analytics Engine instance by using IBM CloudÂ® console To configure your Analytics Engine instance from the IBM CloudÂ® Resource list, complete the following steps: Log in to your IBM CloudÂ® account. Access the IBM CloudÂ® Resource list. Search your Analytics Engine instance and click the instance to see the details. Click Manage > Configuration to view the configuration. In the Default Spark configuration section, click Edit. Add the following configuration to the Default Spark configuration section. spark.sql.catalogImplementation = hive spark.sql.extensions = org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions spark.sql.iceberg.vectorization.enabled = false spark.sql.catalog.lakehouse = org.apache.iceberg.spark.SparkCatalog spark.sql.catalog.lakehouse.type = hive spark.sql.catalog.lakehouse.uri = for example (thrift://81823aaf-8a88-4bee-a0a1- 6e76a42dc833.cfjag3sf0s5o87astjo0.databases.appdomain.cloud:32683) spark.hive.metastore.client.auth.mode = PLAIN spark.hive.metastore.client.plain.username = (for example, ibmlhapikey) spark.hive.metastore.client.plain.password = spark.hive.metastore.use.SSL = true spark.hive.metastore.truststore.type = JKS spark.hive.metastore.truststore.path = file:///opt/ibm/jdk/lib/security/cacerts spark.hive.metastore.truststore.password = changeit Parameter value: hms-thrift-endpoint-from- watsonx.Data: Specify the credentials for watsonx.data. hms-user-from-watsonx.Data: The watsonx.data username. hms-password-from- watsonx.Data: The watsonx.data password. Configuring Analytics Engine instance by using Analytics Engine API To configure your IBM Analytics Engine instance from the Analytics Engine API, complete the following steps: Generate an IAM token to connect to the IBM Analytics Engine API. For more information about how to generate an IAM token, see IAM token. Run the following API command to invoke the Analytics Engine API by using the generated IAM token. curl -X PATCH --location --header "Authorization: Bearer {IAM\_TOKEN}" --header "Accept: application/json" --header "Content-Type: application/merge-patch+json" --data '{ }' " {BASE\_URL}/v3/analytics\_engines/{INSTANCE\_ID/default\_configs" Parameter value: IAM\_TOKEN: Specify the API token generated for the Analytics Engine API. CONFIGURATION\_DETAILS: Copy and paste the following command:{ "spark.sql.catalogImplementation": "hive", "spark.sql.extensions": "org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions", "spark.sql.iceberg.vectorization.enabled": "false", "spark.sql.catalog.lakehouse": "org.apache.iceberg.spark.SparkCatalog", "spark.sql.catalog.lakehouse.type": "hive", "spark.sql.catalog.lakehouse.uri": " for example (thrift://81823aaf-8a88-4bee-a0a1- 6e76a42dc833.cfjag3sf0s5o87astjo0.databases.appdomain.cloud:32683) ", "spark.hive.metastore.client.auth.mode": "PLAIN", "spark.hive.metastore.client.plain.username": " (for example, ibmlhapikey)", "spark.hive.metastore.client.plain.password": "", "spark.hive.metastore.use.SSL": "true", "spark.hive.metastore.truststore.type": "JKS", "spark.hive.metastore.truststore.path": "file:///opt/ibm/jdk/lib/security/cacerts", "spark.hive.metastore.truststore.password": "changeit" } BASE\_URL: The Analytics Engine URL for the region where you provisioned the instance. For example, api.region.ae.ibmcloud.com. INSTANCE\_ID: The Analytics Engine instance ID. For more information about how to retrieve an instance ID, see Obtaining the service endpoints. hms-thrift-endpoint-from-watsonx.data: Specify the credentials for watsonx.data. hms-user-from-watsonx.data: The watsonx.data username. hms-password-from-watsonx.data: The watsonx.data password. Configuring Analytics Engine instance by using Analytics Engine CLI To specify the configuration settings for your IBM Analytics Engine instance from CLI, complete the following steps: Run the following command : ibmcloud analytics-engine-v3 instance default-configs- update [--id INSTANCE\_ID] --body BODY Parameter value: BODY: Copy and paste the following configuration information:{ "spark.sql.catalogImplementation": "hive", "spark.sql.extensions": "org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions", "spark.sql.iceberg.vectorization.enabled": "false", "spark.sql.catalog.lakehouse": "org.apache.iceberg.spark.SparkCatalog", "spark.sql.catalog.lakehouse.type": "hive", "spark.sql.catalog.lakehouse.uri": " for example (thrift://81823aaf-8a88-4bee-a0a1- 6e76a42dc833.cfjag3sf0s5o87astjo0.databases.appdomain.cloud:32683) ", "spark.hive.metastore.client.auth.mode": "PLAIN", "spark.hive.metastore.client.plain.username": " (for example, ibmlhapikey)", "spark.hive.metastore.client.plain.password": "", "spark.hive.metastore.use.SSL": "true", "spark.hive.metastore.truststore.type": "JKS", "spark.hive.metastore.truststore.path": "file:///opt/ibm/jdk/lib/security/cacerts", "spark.hive.metastore.truststore.password": "changeit" } INSTANCE\_ID: The Analytics Engine instance ID. For more information about how to retrieve an instance ID, see Obtaining the service endpoints hms-thrift-endpoint-from-watsonx.data: Specify the credentials for watsonx.data. For more information on getting the HMS credentials, see Getting (Hive metastore) HMS Credentials. hms-user-from-watsonx.data: The watsonx.data username. For more information on getting the HMS credentials, see Getting (Hive metastore) HMS Credentials. hms-password-from-watsonx.data: The watsonx.data password. For more information on getting the HMS credentials, see Getting (Hive metastore) HMS Credentials. To view logs of Spark application ran on IBM Analytics Engine you have to enable logging. For more information, see Configuring and viewing logs. Configuring Analytics Engine You can configure IBM Analytics Engine instance to connect to the IBMÂ® watsonx.data instance by setting watsonx.data configurations and Spark related configuration as the default configuration for the IBM Analytics Engine instance. You can configure Analytics Engine instance with default settings in one of the following ways: Configure by using the IBM CloudÂ® console. Configure by using the IBM CloudÂ® console Configure by using the Analytics Engine API. Configure by using the Analytics Engine API Configure by using the Analytics Engine CLI. Configure by using the Analytics Engine CLI Prerequisites Ensure you have the following instances ready: IBMÂ® watsonx.data instance. IBM Analytics Engine instance. Fetch the following information from IBMÂ® watsonx.data: HMS URL from watsonx.data.For more information on getting the HMS credentials, see Getting (Hive metastore) HMS Credentials. Getting (Hive metastore) HMS Credentials HMS Credentials from watsonx.data. For more information on getting the HMS credentials, see Getting (Hive metastore) HMS Credentials. Getting (Hive metastore) HMS Credentials Configuring Analytics Engine instance by using IBM CloudÂ® console To configure your Analytics Engine instance from the IBM CloudÂ® Resource list, complete the following steps: Log in to your IBM CloudÂ® account. Log in to your IBM CloudÂ® account. Access the IBM CloudÂ® Resource list. Access the IBM CloudÂ® Resource list. IBM CloudÂ® Resource list Search your Analytics Engine instance and click the instance to see the details. Search your Analytics Engine instance and click the instance to see the details. Click Manage > Configuration to view the configuration. Click Manage > Configuration to view the configuration. In the Default Spark configuration section, click Edit. In the Default Spark configuration section, click Edit. Add the following configuration to the Default Spark configuration section. spark.sql.catalogImplementation = hive spark.sql.extensions = org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions spark.sql.iceberg.vectorization.enabled = false spark.sql.catalog.lakehouse = org.apache.iceberg.spark.SparkCatalog spark.sql.catalog.lakehouse.type = hive spark.sql.catalog.lakehouse.uri = for example (thrift://81823aaf-8a88-4bee-a0a1-6e76a42dc833.cfjag3sf0s5o87astjo0.databases.appdomain.cloud:32683) spark.hive.metastore.client.auth.mode = PLAIN spark.hive.metastore.client.plain.username = (for example, ibmlhapikey) spark.hive.metastore.client.plain.password = spark.hive.metastore.use.SSL = true spark.hive.metastore.truststore.type = JKS spark.hive.metastore.truststore.path = file:///opt/ibm/jdk/lib/security/cacerts spark.hive.metastore.truststore.password = changeit Add the following configuration to the Default Spark configuration section. Parameter value: hms-thrift-endpoint-from-watsonx.Data: Specify the credentials for watsonx.data. hms-user-from-watsonx.Data: The watsonx.data username. hms-password-from-watsonx.Data: The watsonx.data password. Configuring Analytics Engine instance by using Analytics Engine API To configure your IBM Analytics Engine instance from the Analytics Engine API, complete the following steps: Generate an IAM token to connect to the IBM Analytics Engine API. For more information about how to generate an IAM token, see IAM token. Generate an IAM token to connect to the IBM Analytics Engine API. For more information about how to generate an IAM token, see IAM token. IAM token Run the following API command to invoke the Analytics Engine API by using the generated IAM token. Run the following API command to invoke the Analytics Engine API by using the generated IAM token. Parameter value: IAM\_TOKEN: Specify the API token generated for the Analytics Engine API. CONFIGURATION\_DETAILS: Copy and paste the following command:{ "spark.sql.catalogImplementation": "hive", "spark.sql.extensions": "org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions", "spark.sql.iceberg.vectorization.enabled": "false", "spark.sql.catalog.lakehouse": "org.apache.iceberg.spark.SparkCatalog", "spark.sql.catalog.lakehouse.type": "hive", "spark.sql.catalog.lakehouse.uri": " for example (thrift://81823aaf-8a88-4bee-a0a1- 6e76a42dc833.cfjag3sf0s5o87astjo0.databases.appdomain.cloud:32683) ", "spark.hive.metastore.client.auth.mode": "PLAIN", "spark.hive.metastore.client.plain.username": " (for example, ibmlhapikey)", "spark.hive.metastore.client.plain.password": "", "spark.hive.metastore.use.SSL": "true", "spark.hive.metastore.truststore.type": "JKS", "spark.hive.metastore.truststore.path": "file:///opt/ibm/jdk/lib/security/cacerts", "spark.hive.metastore.truststore.password": "changeit" } BASE\_URL: The Analytics Engine URL for the region where you provisioned the instance. For example, api.region.ae.ibmcloud.com. INSTANCE\_ID: The Analytics Engine instance ID. For more information about how to retrieve an instance ID, see Obtaining the service endpoints. Obtaining the service endpoints hms-thrift-endpoint- from-watsonx.data: Specify the credentials for watsonx.data. hms-user-from-watsonx.data: The watsonx.data username. hms-password-from- watsonx.data: The watsonx.data password. Configuring Analytics Engine instance by using Analytics Engine CLI To specify the configuration settings for your IBM Analytics Engine instance from CLI, complete the following steps: Run the following command : Parameter value: BODY: Copy and paste the following configuration information:{ "spark.sql.catalogImplementation": "hive", "spark.sql.extensions": "org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions", "spark.sql.iceberg.vectorization.enabled": "false", "spark.sql.catalog.lakehouse": "org.apache.iceberg.spark.SparkCatalog", "spark.sql.catalog.lakehouse.type": "hive", "spark.sql.catalog.lakehouse.uri": " for example (thrift://81823aaf-8a88-4bee-a0a1- 6e76a42dc833.cfjag3sf0s5o87astjo0.databases.appdomain.cloud:32683) ", "spark.hive.metastore.client.auth.mode": "PLAIN", "spark.hive.metastore.client.plain.username": " (for example, ibmlhapikey)", "spark.hive.metastore.client.plain.password": "", "spark.hive.metastore.use.SSL": "true", "spark.hive.metastore.truststore.type": "JKS", "spark.hive.metastore.truststore.path": "file:///opt/ibm/jdk/lib/security/cacerts", "spark.hive.metastore.truststore.password": "changeit" } INSTANCE\_ID: The Analytics Engine instance ID. For more information about how to retrieve an instance ID, see Obtaining the service endpoints Obtaining the service endpoints hms-thrift- endpoint-from-watsonx.data: Specify the credentials for watsonx.data. For more information on getting the HMS credentials, see Getting (Hive metastore) HMS Credentials. Getting (Hive metastore) HMS Credentials hms-user-from-watsonx.data: The watsonx.data username. For more information on getting the HMS credentials, see Getting (Hive metastore) HMS Credentials. Getting (Hive metastore) HMS Credentials hms- password-from-watsonx.data: The watsonx.data password. For more information on getting the HMS credentials, see Getting (Hive metastore) HMS Credentials. Getting (Hive metastore) HMS Credentials To view logs of Spark application ran on IBM Analytics Engine you have to enable logging. For more information, see Configuring and viewing logs. Configuring and viewing logs
